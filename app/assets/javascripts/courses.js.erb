$(function () {
  $(".course").sortable({
    items: '.span4'
  });
  $("ul.section").sortable({
    containment: 'parent',
    connectWith: 'ul.section'
  });
  $("ul.lesson-sortable").sortable({
    containment: 'parent',
    connectWith: 'ul.lesson'
  });

  $("input#save_order").click(function (click) {
    var inputs = ['input.course', 'input.section_number', 'input.lesson'];
    inputs.forEach(function(item) {
      var count = 1;
      $(item).each(function() {
        $(this).val(count++)
      });
    });

    $.each($('input.section_course_id'), function() {
      var course_id = $(this).parents('li.course').attr('id');
      var id = course_id.substr(8);
      $(this).val(id);
    });

    $.each($('input.lesson_section_id'), function() {
      var section_id = $(this).parents('li.section').attr('id');
      var id = section_id.substr(8);
      $(this).val(id);
    });
  });
});
