<% provide :title, @query.nil? ? "Table of contents" : "Lessons containing '#{@query}'" %>

<h1><%= yield :title %></h1>

<%= render 'lessons/search' %>

<ul class='chapter' id="sortable">
  <% @chapters.each do |chapter| %>
    <%= render chapter, :locals => {:chapter => chapter} %>
  <% end%>
</ul>

<% if can? :create, Chapter %>
  <p><%= link_to 'New chapter', new_chapter_path, :remote => true, :class => "btn btn-primary btn-large", :id => "new_chapter_link" %>
<% end%>

<% if can? :create, Section %>
  <p><%= link_to 'New section', new_section_path, :class => "btn btn-warning btn-large" %></p>
<% end %>

<% if can? :create, Lesson %>
  <p><%= link_to 'New lesson', new_lesson_path, :class => "btn btn-success btn-large" %></p>
<% end %>
